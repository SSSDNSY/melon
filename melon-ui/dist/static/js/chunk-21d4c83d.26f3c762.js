(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21d4c83d","chunk-18f9fdc8","chunk-2e4a0f88"],{"194c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{title:"用户",visible:e.visible,width:"60%","append-to-body":"","close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},close:e.close}},[a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:20,xs:24}},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"归属部门",prop:"deptId"}},[a("treeselect",{staticStyle:{width:"240px"},attrs:{options:e.deptOptions,"show-count":!0,placeholder:"请选择归属部门"},model:{value:e.queryParams.deptId,callback:function(t){e.$set(e.queryParams,"deptId",t)},expression:"queryParams.deptId"}})],1),a("el-form-item",{attrs:{label:"用户名称",prop:"userName"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入用户名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.userName,callback:function(t){e.$set(e.queryParams,"userName",t)},expression:"queryParams.userName"}})],1),a("el-form-item",{attrs:{label:"手机号码",prop:"phonenumber"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"请输入手机号码",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.phonenumber,callback:function(t){e.$set(e.queryParams,"phonenumber",t)},expression:"queryParams.phonenumber"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("right-toolbar",{attrs:{showSearch:e.showSearch,columns:e.columns},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:e.userList,"row-key":e.getRowKey},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"50",align:"center"}}),e.columns[0].visible?a("el-table-column",{key:"userId",attrs:{label:"用户编号",align:"center",prop:"userId"}}):e._e(),e.columns[1].visible?a("el-table-column",{key:"userName",attrs:{label:"用户名称",align:"center",prop:"userName","show-overflow-tooltip":!0}}):e._e(),e.columns[2].visible?a("el-table-column",{key:"nickName",attrs:{label:"用户昵称",align:"center",prop:"nickName","show-overflow-tooltip":!0}}):e._e(),e.columns[3].visible?a("el-table-column",{key:"deptName",attrs:{label:"部门",align:"center",prop:"dept.deptName","show-overflow-tooltip":!0}}):e._e(),e.columns[4].visible?a("el-table-column",{key:"phonenumber",attrs:{label:"手机号码",align:"center",prop:"phonenumber",width:"120"}}):e._e(),e.columns[5].visible?a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}],null,!1,3078210614)}):e._e()],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)],1)],1),a("div",e._l(e.chooseUserList,(function(t){return a("el-tag",{key:t.userName,staticStyle:{margin:"2px"},attrs:{closable:""},on:{close:function(a){return e.handleCloseTag(t)}}},[e._v(e._s(t.userName)+" ")])})),1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{loading:e.buttonLoading,type:"primary"},on:{click:e.confirmUser}},[e._v("确认")]),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)])},i=[],r=(a("d3b7"),a("159b"),a("4de4"),a("c740"),a("a434"),a("4cd5")),s=a("c0c7"),o=a("ca17"),l=a.n(o),c=(a("542c"),{props:{multiple:{type:Boolean,default:!0},dataObj:{type:Object,default:{}},nodeId:{type:String,default:""}},name:"User",dicts:["sys_user_sex"],components:{Treeselect:l.a},data:function(){return{loading:!0,buttonLoading:!1,visible:!1,showSearch:!0,total:0,userList:[],deptOptions:void 0,queryParams:{pageNum:1,pageSize:10,userName:void 0,phonenumber:void 0,deptId:void 0,type:void 0,params:void 0,ids:[]},columns:[{key:0,label:"用户编号",visible:!0},{key:1,label:"用户名称",visible:!0},{key:2,label:"用户昵称",visible:!0},{key:3,label:"部门",visible:!0},{key:4,label:"手机号码",visible:!0},{key:5,label:"创建时间",visible:!0}],chooseUserList:[],getRowKey:function(e){return e.userId}}},watch:{dataObj:function(e){var t=this;this.queryParams.params=e.assigneeId,this.queryParams.type=e.chooseWay,this.queryParams.ids=e.ids,this.$nextTick((function(){t.$refs.multipleTable.clearSelection()})),this.getList()}},created:function(){this.getTreeselect()},methods:{getList:function(){var e=this;this.loading=!0,this.chooseUserList=[],Object(r["b"])(this.queryParams).then((function(t){var a=t.data.page;e.userList=a.rows,e.total=a.total,t.data.list&&(e.chooseUserList=t.data.list,t.data.list.forEach((function(t){e.$refs.multipleTable.toggleRowSelection(t,!0)}))),e.loading=!1}))},getTreeselect:function(){var e=this;Object(s["d"])().then((function(t){e.deptOptions=t.data}))},cancel:function(){this.visible=!1,this.chooseUserList=[]},close:function(){this.visible=!1,this.chooseUserList=[]},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){},handleSelectionChange:function(e){if(this.multiple)this.chooseUserList=e.filter((function(e,t,a){return a.findIndex((function(t){return t.userId===e.userId}))===t}));else{if(this.chooseUserList=e,e.length>1){var t=e.shift();this.$refs.multipleTable.toggleRowSelection(t,!1)}0===e.length&&(this.chooseUserList=null)}},handleCloseTag:function(e){var t=this;this.chooseUserList.splice(this.chooseUserList.indexOf(e),1),this.$refs.multipleTable.toggleRowSelection(e,!1),this.userList.forEach((function(a,n){e.userId===a.userId&&t.$refs.multipleTable.toggleRowSelection(t.userList[n],!1)}))},confirmUser:function(){this.chooseUserList.length>0?(this.$emit("confirmUser",this.chooseUserList,this.nodeId),this.visible=!1):this.$modal.msgWarning("请选择人员！")}}}),u=c,d=a("2877"),m=Object(d["a"])(u,n,i,!1,null,"6e26d3af",null);t["default"]=m.exports},3891:function(e,t,a){"use strict";a("5ce7")},"5ce7":function(e,t,a){},"724d":function(e,t,a){},"737e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[e.dataViewVisible?a("div",[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"表单key",prop:"formKey"}},[a("el-input",{attrs:{placeholder:"请输入表单key",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.formKey,callback:function(t){e.$set(e.queryParams,"formKey",t)},expression:"queryParams.formKey"}})],1),a("el-form-item",{attrs:{label:"表单名称",prop:"formName"}},[a("el-input",{attrs:{placeholder:"请输入表单名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.formName,callback:function(t){e.$set(e.queryParams,"formName",t)},expression:"queryParams.formName"}})],1),a("el-form-item",{attrs:{label:"单号",prop:"applyCode"}},[a("el-input",{attrs:{placeholder:"请输入单号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.applyCode,callback:function(t){e.$set(e.queryParams,"applyCode",t)},expression:"queryParams.applyCode"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["workflow:businessForm:export"],expression:"['workflow:businessForm:export']"}],attrs:{type:"warning",plain:"",icon:"el-icon-download",size:"mini"},on:{click:e.handleExport}},[e._v("导出")])],1),a("right-toolbar",{attrs:{showSearch:e.showSearch},on:{"update:showSearch":function(t){e.showSearch=t},"update:show-search":function(t){e.showSearch=t},queryTable:e.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.businessFormList},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"单号",align:"center",prop:"applyCode"}}),a("el-table-column",{attrs:{label:"表单key",align:"center",prop:"formKey"}}),a("el-table-column",{attrs:{label:"表单名称",align:"center",prop:"formName"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return["draft"===t.row.actBusinessStatus.status||"back"===t.row.actBusinessStatus.status||"cancel"===t.row.actBusinessStatus.status?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["workflow:businessForm:edit"],expression:"['workflow:businessForm:edit']"}],attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleUpdate(t.row)}}},[e._v("修改")]):e._e(),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(a){return e.handleView(t.row)}}},[e._v("查看")]),"draft"===t.row.actBusinessStatus.status||"back"===t.row.actBusinessStatus.status||"cancel"===t.row.actBusinessStatus.status?a("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["workflow:businessForm:remove"],expression:"['workflow:businessForm:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")]):e._e(),"waiting"===t.row.actBusinessStatus.status?a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-back"},on:{click:function(a){return e.cancelProcessApply(t.row)}}},[e._v("撤销")]):e._e()]}}],null,!1,3266672303)})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1):e._e(),e.dynamicFormEditVisible?a("div",{staticClass:"form-container"},[a("div",{staticClass:"form-container-header"},[a("i",{staticClass:"el-dialog__close el-icon el-icon-close",on:{click:e.closeDynamicEdit}})]),a("el-tabs",{staticClass:"container-tab",attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"业务单据"}},[a("dynamicFormEdit",{ref:"dynamicFormEditRef",attrs:{buildData:e.form.formText},on:{draftForm:function(t){return e.draftProcessForm(arguments)},submitForm:function(t){return e.submitProcessForm(arguments)}},model:{value:e.form.formValue,callback:function(t){e.$set(e.form,"formValue",t)},expression:"form.formValue"}})],1),e.processInstanceId?a("el-tab-pane",{attrs:{label:"审批意见"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.historyList,border:"",stripe:"","max-height":"570"}},[a("el-table-column",{attrs:{label:"流程审批历史记录",align:"center"}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"任务名称",align:"center"}}),a("el-table-column",{attrs:{prop:"nickName",label:"办理人",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"}}),a("el-table-column",{attrs:{prop:"comment",label:"审批意见",align:"center"}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center"}}),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center"}})],1)],1)],1):e._e(),e.processInstanceId?a("el-tab-pane",{attrs:{label:"流程进度"}},[a("el-image",{staticStyle:{"font-size":"20px",margin:"50px"},attrs:{src:e.url}},[a("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[a("i",{staticClass:"el-icon-loading"}),e._v(" 流程审批历史图加载中……")])])],1):e._e()],1)],1):e._e(),e.dynamicFormViewVisible?a("div",{staticClass:"form-container"},[a("div",{staticClass:"form-container-header"},[a("i",{staticClass:"el-dialog__close el-icon el-icon-close",on:{click:e.closeDynamicView}})]),a("el-tabs",{staticClass:"container-tab",attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"业务单据"}},[a("dynamicFormView",{attrs:{buildData:e.form.formText},model:{value:e.form.formValue,callback:function(t){e.$set(e.form,"formValue",t)},expression:"form.formValue"}})],1),e.processInstanceId?a("el-tab-pane",{attrs:{label:"审批意见"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.historyList,border:"",stripe:"","max-height":"570"}},[a("el-table-column",{attrs:{label:"流程审批历史记录",align:"center"}},[a("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),a("el-table-column",{attrs:{prop:"name",label:"任务名称",align:"center"}}),a("el-table-column",{attrs:{prop:"nickName",label:"办理人",align:"center"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"}}),a("el-table-column",{attrs:{prop:"comment",label:"审批意见",align:"center"}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间",align:"center"}}),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",align:"center"}})],1)],1)],1):e._e(),e.processInstanceId?a("el-tab-pane",{attrs:{label:"流程进度"}},[a("el-image",{staticStyle:{"font-size":"20px",margin:"50px"},attrs:{src:e.url}},[a("div",{attrs:{slot:"placeholder"},slot:"placeholder"},[a("i",{staticClass:"el-icon-loading"}),e._v(" 流程审批历史图加载中……")])])],1):e._e()],1)],1):e._e(),a("verify",{ref:"verifyRef",attrs:{taskId:e.taskId,taskVariables:e.taskVariables,sendMessage:e.sendMessage},on:{submitCallback:e.submitCallback}})],1)},i=[],r=a("5530"),s=a("c7eb"),o=a("1da1"),l=(a("d81d"),a("d3b7"),a("7ee7")),c=a("ca1c"),u=a("91ab"),d=a("d5cd"),m=a("e075"),f={name:"BusinessForm",components:{dynamicFormEdit:c["default"],dynamicFormView:u["default"],verify:d["a"]},data:function(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,businessFormList:[],title:"",queryParams:{pageNum:1,pageSize:10,formKey:void 0,formName:void 0,applyCode:void 0},form:{},rules:{},dataViewVisible:!0,dynamicFormEditVisible:!1,dynamicFormViewVisible:!1,taskId:void 0,taskVariables:{},sendMessage:{},historyList:[],processInstanceId:void 0}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.loading=!0,Object(l["d"])(this.queryParams).then((function(t){e.businessFormList=t.rows,e.total=t.total,e.loading=!1}))},getHistoryInfoList:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){var a,n;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,m["a"].getHistoryInfoList(e.processInstanceId);case 2:a=t.sent,n=a.data,e.historyList=n;case 5:case"end":return t.stop()}}),t)})))()},getHistoryImage:function(){this.url="/melon/workflow/processInstance/getHistoryProcessImage?processInstanceId="+this.processInstanceId},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.single=1!==e.length,this.multiple=!e.length},handleUpdate:function(e){var t=this;this.loading=!0;var a=e.id||this.ids;Object(l["c"])(a).then((function(e){t.loading=!1,t.form=e.data,t.processInstanceId=e.data.actBusinessStatus.processInstanceId,t.processInstanceId&&(t.getHistoryInfoList(),t.getHistoryImage()),t.dynamicFormEditVisible=!0,t.dataViewVisible=!1,t.title=e.data.formName}))},handleView:function(e){var t=this;this.loading=!0;var a=e.id||this.ids;Object(l["c"])(a).then((function(e){t.loading=!1,t.form=e.data,t.processInstanceId=e.data.actBusinessStatus.processInstanceId,t.processInstanceId&&(t.getHistoryInfoList(),t.getHistoryImage()),t.dynamicFormViewVisible=!0,t.dataViewVisible=!1,t.title=e.data.formName}))},closeDynamicEdit:function(){this.dynamicFormEditVisible=!1,this.dataViewVisible=!0,this.getList()},closeDynamicView:function(){this.dynamicFormViewVisible=!1,this.dataViewVisible=!0,this.getList()},draftProcessForm:function(e){var t=this;this.form.formText=e[0],this.form.formValue=e[1],this.form.status="draft",null!=this.form.id&&Object(l["e"])(this.form).then((function(e){t.$modal.msgSuccess("修改成功"),t.dynamicFormEditVisible=!1,t.dataViewVisible=!0,t.getList()}))},submitProcessForm:function(e){var t=this;this.sendMessage={title:this.form.formName,messageContent:"单据【"+this.form.applyCode+"】申请"},this.form.formText=e[0],this.form.formValue=e[1],this.form.status="waiting",null!=this.form.id&&Object(l["e"])(this.form).then((function(e){t.submitFormApply(e.data)}))},submitFormApply:function(e){var t=this;this.taskVariables={entity:e.variableMap};var a={processKey:e.actProcessDefSetting.processDefinitionKey,businessKey:e.id,variables:this.taskVariables,classFullName:e.formKey};m["a"].startProcessApply(a).then((function(e){t.taskId=e.data.taskId,t.$refs.verifyRef.visible=!0,t.$refs.verifyRef.reset()}))},submitCallback:function(){this.dynamicFormEditVisible=!1,this.dataViewVisible=!0,this.getList()},cancelProcessApply:function(e){var t=this;this.$modal.confirm("是否撤销申请").then((function(){return t.loading=!0,m["a"].cancelProcessApply(e.actBusinessStatus.processInstanceId)})).then((function(){t.getList(),t.$modal.msgSuccess("撤回成功")})).finally((function(){t.loading=!1}))},handleDelete:function(e){var t=this,a=e.id||this.ids;this.$modal.confirm('是否确认删除业务表单编号为"'+a+'"的数据项？').then((function(){return t.loading=!0,Object(l["b"])(a)})).then((function(){t.loading=!1,t.getList(),t.$modal.msgSuccess("删除成功")})).finally((function(){t.loading=!1}))},handleExport:function(){this.download("workflow/businessForm/export",Object(r["a"])({},this.queryParams),"businessForm_".concat((new Date).getTime(),".xlsx"))}}},p=f,h=(a("e9a1"),a("2877")),b=Object(h["a"])(p,n,i,!1,null,"e3ee64ba",null);t["default"]=b.exports},"74bc":function(e,t,a){},"7ee7":function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a("b775");function i(e){return Object(n["a"])({url:"/workflow/businessForm/list",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/workflow/businessForm/"+e,method:"get"})}function s(e){return Object(n["a"])({url:"/workflow/businessForm",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/workflow/businessForm",method:"put",data:e})}function l(e){return Object(n["a"])({url:"/workflow/businessForm/"+e,method:"delete"})}},"91ab":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-viewer"},[a("el-row",{attrs:{gutter:e.formConf.gutter}},[a("el-form",{ref:e.formConf.formModel,attrs:{size:e.formConf.size,model:e.form,"label-position":e.formConf.labelPosition,disabled:e.formConf.disabled}},[e._l(e.itemList,(function(t,n){return["row"===t.compType?a("preview-row-item",{key:"row-"+n,attrs:{model:t}},e._l(t.columns,(function(t){return a("el-col",{key:t.index,attrs:{span:t.span}},e._l(t.list,(function(t){return a("form-view-item",{key:t.id,attrs:{model:t},model:{value:e.form[t.id],callback:function(a){e.$set(e.form,t.id,a)},expression:"form[item.id]"}})})),1)})),1):"dynamicTable"===t.compType?a("fancy-dynamic-view-table",{key:"dynamic-"+n,ref:t.id,refInFor:!0,attrs:{data:e.form[t.id],conf:t},scopedSlots:e._u([{key:"item",fn:function(n){var i=n.rowScope,r=n.item;return[a("fancy-dynamic-table-view-item",{key:"tableIndex-"+i.$index,ref:r.id+i.$index,refInFor:!0,attrs:{model:r,parent:t,index:i.$index},model:{value:i.row[r.id],callback:function(t){e.$set(i.row,r.id,t)},expression:"rowScope.row[item.id]"}})]}}],null,!0)}):"table"===t.compType?a("fancy-edit-table",{attrs:{layoutArray:t.layoutArray,tdStyle:t.tdStyle,width:t.width,height:t.height},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.td;return e._l(n.columns,(function(t){return a("form-view-item",{key:t.id,attrs:{model:t},model:{value:e.form[t.id],callback:function(a){e.$set(e.form,t.id,a)},expression:"form[item.id]"}})}))}}],null,!0)}):a("el-col",{key:n,staticClass:"drag-col-wrapper",attrs:{span:t.span}},[a("form-view-item",{attrs:{model:t},model:{value:e.form[t.id],callback:function(a){e.$set(e.form,t.id,a)},expression:"form[element.id]"}})],1)]}))],2)],1)],1)},i=[],r=(a("b64b"),a("53ca")),s=(a("d3b7"),a("159b"),a("0f1a")),o=a("3c5a"),l=a("f655"),c=a("5f87"),u=a("d0f3");function d(e,t){if(t.props.value=e.value,t.on.input=function(t){e.$emit("input",t)},"upload"===e.conf.compType){if(t.attrs["headers"]={Authorization:"Bearer "+Object(c["a"])()},void 0!==t.props.value&&""!==t.props.value){var a=JSON.parse(t.props.value);t.props["file-list"]=a}t.attrs["on-preview"]=function(e){console.log("on-preview file",e),u["a"].oss(e.ossId)}}}var m,f,p,h,b={render:function(e){var t={attrs:{},props:{},on:{},style:{}};this.getRemoteData();var a=Object(s["b"])(this.conf),n=Object(o["default"])(e,a);return Object.keys(a).forEach((function(e){var n=a[e];t[e]?t[e]=n:"width"===e?t.style="width:"+n+"%":Object(s["a"])(e)?t.attrs[e]=n:t.props[e]=n})),d(this,t),e(a.ele,t,n)},props:["conf","value"],mixins:[l["a"]]},y={colItem:function(e,t,a){var n=this;t.disabled=!0;var i=t.labelWidth?"".concat(t.labelWidth,"px"):null;return"component"===t.viewType?e("el-form-item",{attrs:{label:t.showLabel?t.label:"","label-width":i,prop:t.id}},[e(b,{key:t.id,attrs:{conf:t,value:a},on:{input:function(e){n.$set(t,"value",e)}}})]):"html"===t.viewType?e("el-form-item",{attrs:{label:t.showLabel?t.label:"","label-width":i,prop:t.id}},[e("fancy-html",{attrs:{text:a}})]):("object"===Object(r["a"])(a)&&(a=a[0]+" "+t["range-separator"]+" "+a[1]),e("el-form-item",{attrs:{label:t.showLabel?t.label:"","label-width":i,prop:t.id}},[a]))}},w={name:"formViewItem",components:{render:b},props:["model","value"],data:function(){return{eleConfig:this.model}},render:function(e){return y.colItem.call(this,e,this.eleConfig,this.value)}},v=w,g=(a("fdfd"),a("2877")),k=Object(g["a"])(v,m,f,!1,null,"5946c906",null),x=k.exports,I=a("38a4"),S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fancyDynamicTable"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.data,fit:!0,border:"",size:"mini","cell-style":{padding:"5px 0"},"header-cell-style":{background:"#F5F7FA"},"show-summary":e.conf["show-summary"],"summary-method":e.sumTotal}},[e.conf.showIndex?a("el-table-column",{attrs:{align:"center",type:"index",label:"序号",width:"50px",fixed:"left"}}):e._e(),e._l(e.conf.columns,(function(t,n){return a("el-table-column",{key:n,attrs:{align:"center",prop:t.id,"min-width":"150px;"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._t("item",null,{rowScope:a,item:t})]}}],null,!0)},[a("template",{slot:"header"},[e._v(" "+e._s(e.tableColumnLables[n])+" ")])],2)}))],2)],1)},_=[],C=(a("14d9"),a("d81d"),a("a9e3"),a("13d5"),{name:"fancyDynamicViewTable",props:["data","conf"],data:function(){return{tableColumns:[],tableColumnLables:[]}},mounted:function(){var e=this;this.conf.columns.forEach((function(t){e.tableColumnLables.push(t.label);var a={};Object.assign(a,t),e.tableColumns.push(a)}))},methods:{sumTotal:function(e){var t=this,a=e.columns,n=e.data,i=[];return a.forEach((function(e,a){if(0!==a){var r=n.map((function(t){return Number(t[e.property])}));r.every((function(e){return isNaN(e)}))?i[a]="":(i[a]=r.reduce((function(e,t){var a=Number(t);return isNaN(a)?e:e+t}),0),i[a]+=" "+t.conf["summary-text"])}else i[a]=t.conf["sum-text"]})),i}}}),P=C,O=(a("3891"),Object(g["a"])(P,S,_,!1,null,"59e5027b",null)),F=O.exports,V={colItem:function(e,t,a){var n=this;t.disabled=!0;t.labelWidth&&"".concat(t.labelWidth,"px");return"component"===t.viewType?e(b,{key:t.id,attrs:{conf:t,value:a},on:{input:function(e){n.$set(t,"value",e)}}}):"html"===t.viewType?e("fancy-html",{attrs:{text:a}}):e("fancy-text",{attrs:{text:a,align:"center"}})}},$={name:"fancyDynamicTableViewItem",components:{render:b},props:["model","value"],data:function(){return{eleConfig:this.model}},render:function(e){return V.colItem.call(this,e,this.eleConfig,this.value)}},L=$,N=(a("cee44"),Object(g["a"])(L,p,h,!1,null,null,null)),T=N.exports,j=a("70da"),D={name:"dynamicFormView",data:function(){return{}},props:{value:{type:String,default:""},buildData:{type:String,default:""}},components:{formViewItem:x,previewRowItem:I["a"],fancyDynamicViewTable:F,fancyDynamicTableViewItem:T,fancyEditTable:j["a"]},mounted:function(){this.$nextTick((function(){}))},computed:{itemList:function(){if(""!==this.buildData){var e=JSON.parse(this.buildData);return e.list}return[]},form:function(){if(""!==this.value&&null!==this.value){var e=JSON.parse(this.value);return e}return{}},formConf:function(){if(""!==this.buildData){var e=JSON.parse(this.buildData);return e.config.disabled=this.disabled,e.config}return{}}}},q=D,E=(a("e2ff"),Object(g["a"])(q,n,i,!1,null,"6579fb5b",null));t["default"]=E.exports},9538:function(e,t,a){"use strict";a("99f9")},"99f9":function(e,t,a){},"9af6":function(e,t,a){var n={"./el-button.js":"f585","./el-checkbox-group.js":"2e71","./el-divider.js":"651c","./el-input.js":"4262","./el-link.js":"83b6","./el-radio-group.js":"c81f","./el-select.js":"f133","./el-upload.js":"59f6","./index.js":"3c5a"};function i(e){var t=r(e);return a(t)}function r(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=r,e.exports=i,i.id="9af6"},bde3:function(e,t,a){},ca1c:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"btn"},[a("div",{staticClass:"btn-content"},[a("span",[a("el-button",{attrs:{type:"info"},on:{click:e.draftForm}},[e._v("暂存")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")])],1)])]),a("div",[a("el-row",{staticClass:"form-builder",attrs:{gutter:e.formConf.gutter}},[a("el-form",{ref:e.formConf.formModel,attrs:{rules:e.rules,size:e.formConf.size,model:e.form,"label-position":e.formConf.labelPosition,disabled:e.formConf.disabled,"validate-on-rule-change":!1,"label-width":e.formConf.labelWidth+"px"}},[e._l(e.itemList,(function(t,n){return["row"===t.compType?a("preview-row-item",{key:"row-"+n,attrs:{model:t}},e._l(t.columns,(function(t){return a("el-col",{key:t.index,attrs:{span:t.span}},[e._l(t.list,(function(t){return["dynamicTable"!==t.compType?a("preview-item",{key:t.id,attrs:{model:t},on:{valChange:e.handlerValChange},model:{value:e.form[t.id],callback:function(a){e.$set(e.form,t.id,a)},expression:"form[col.id]"}}):"dynamicTable"===t.compType?a("fancy-dynamic-table",{key:"dynamic-"+n,ref:"dynamicTable",refInFor:!0,attrs:{data:e.form[t.id],conf:t},on:{addRow:e.handlerAddRow,deleteRow:e.handlerDeleteRow},scopedSlots:e._u([{key:"item",fn:function(n){var i=n.rowScope,r=n.item;return[a("fancy-dynamic-table-item",{key:"tableIndex-"+i.$index,attrs:{model:r,parent:t,index:i.$index},on:{valChange:e.handlerDynamicValChange},model:{value:i.row[r.id],callback:function(t){e.$set(i.row,r.id,t)},expression:"rowScope.row[item.id]"}})]}}],null,!0)}):e._e()]}))],2)})),1):"dynamicTable"===t.compType?a("fancy-dynamic-table",{key:"dynamic-"+n,ref:t.id,refInFor:!0,attrs:{data:e.form[t.id],conf:t},on:{addRow:e.handlerAddRow,deleteRow:e.handlerDeleteRow},scopedSlots:e._u([{key:"item",fn:function(n){var i=n.rowScope,r=n.item;return[a("fancy-dynamic-table-item",{key:"tableIndex-"+i.$index,ref:r.id+i.$index,refInFor:!0,attrs:{model:r,parent:t,index:i.$index},on:{valChange:e.handlerDynamicValChange},model:{value:i.row[r.id],callback:function(t){e.$set(i.row,r.id,t)},expression:"rowScope.row[item.id]"}})]}}],null,!0)}):"table"===t.compType?a("fancy-edit-table",{attrs:{layoutArray:t.layoutArray,tdStyle:t.tdStyle,width:t.width,height:t.height},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.td;return[e._l(n.columns,(function(t){return["dynamicTable"!==t.compType?a("preview-item",{key:t.id,attrs:{model:t},on:{valChange:e.handlerValChange},model:{value:e.form[t.id],callback:function(a){e.$set(e.form,t.id,a)},expression:"form[col.id]"}}):e._e()]}))]}}],null,!0)}):a("el-col",{key:n,staticClass:"drag-col-wrapper",attrs:{span:t.span}},[a("preview-item",{attrs:{model:t},on:{valChange:e.handlerValChange},model:{value:e.form[t.id],callback:function(a){e.$set(e.form,t.id,a)},expression:"form[element.id]"}})],1)]}))],2)],1)],1)])},i=[],r=(a("b64b"),a("e9c4"),a("0a41")),s=a("38a4"),o=a("ed55"),l=a("2ad6"),c=a("7fe9"),u=a("70da"),d={name:"dynamicFormEdit",props:{value:{type:String,default:""},buildData:{type:String,default:""},disabled:{type:Boolean,default:!1}},components:{previewItem:r["a"],previewRowItem:s["a"],fancyDynamicTable:o["a"],fancyDynamicTableItem:l["a"],fancyEditTable:u["a"]},data:function(){return{form:{},rules:{},currentIndex:-1,formVal:""}},mounted:function(){var e=this;this.$nextTick((function(){if(""!==e.value&&null!==e.value){var t=JSON.parse(e.value);e.handlerFillDatas(t)}}))},methods:{draftForm:function(){this.validate(),this.$emit("draftForm",this.buildData,this.formVal)},submitForm:function(){var e=this;this.validate(),this.$refs[this.formConf.formModel].validate((function(t){t&&e.$emit("submitForm",e.buildData,e.formVal)}))},handlerValChange:function(e,t){this.$set(this.form,e,t)},handlerDynamicValChange:function(e,t,a,n){this.$set(this.form[e][t],a,n),this.currentIndex=t},validate:function(){var e=this;this.$refs[this.formConf.formModel].validate((function(t){t?(e.formVal=JSON.stringify(e.form,null,4),e.$emit("input",JSON.stringify(e.form,null,4))):e.$emit("input","")}))},handlerAddRow:c["a"],handlerDeleteRow:c["c"],handlerInitDatas:c["b"],handlerFillDatas:c["d"]},created:function(){this.handlerInitDatas()},computed:{itemList:function(){if(""!==this.buildData){var e=JSON.parse(this.buildData);return e.list}return[]},formConf:function(){if(""!==this.buildData){var e=JSON.parse(this.buildData);return e.config.disabled=this.disabled,e.config}return{}}}},m=d,f=(a("9538"),a("2877")),p=Object(f["a"])(m,n,i,!1,null,"63233e12",null);t["default"]=p.exports},cee44:function(e,t,a){"use strict";a("fbee")},e075:function(e,t,a){"use strict";var n=a("b775");t["a"]={startProcessApply:function(e){return Object(n["a"])({url:"/workflow/processInstance/startWorkFlow",method:"post",data:e})},getHistoryInfoList:function(e){return Object(n["a"])({url:"/workflow/processInstance/getHistoryInfoList/"+e,method:"get"})},getHistoryProcessImage:function(e){return"/melon"+"/workflow/processInstance/getHistoryProcessImage?processInstId=".concat(e,"&t=")+Math.random()},getInfoByBusinessKey:function(e){return Object(n["a"])({url:"/workflow/actBusiness/getInfoByBusinessKey/"+e,method:"get"})},getProcessInstRunningByPage:function(e){return Object(n["a"])({url:"/workflow/processInstance/getProcessInstRunningByPage",method:"get",params:e})},state:function(e){return Object(n["a"])({url:"/workflow/processInstance/state",method:"put",data:e})},deleteRuntimeProcessInst:function(e){return Object(n["a"])({url:"/workflow/processInstance/deleteRuntimeProcessInst/"+e,method:"delete"})},deleteRuntimeProcessAndHisInst:function(e){return Object(n["a"])({url:"/workflow/processInstance/deleteRuntimeProcessAndHisInst/"+e,method:"delete"})},deleteFinishProcessAndHisInst:function(e){return Object(n["a"])({url:"/workflow/processInstance/deleteFinishProcessAndHisInst/"+e,method:"delete"})},cancelProcessApply:function(e){return Object(n["a"])({url:"/workflow/processInstance/cancelProcessApply/"+e,method:"get"})},getProcessInstFinishByPage:function(e){return Object(n["a"])({url:"/workflow/processInstance/getProcessInstFinishByPage",method:"get",params:e})}}},e2ff:function(e,t,a){"use strict";a("724d")},e9a1:function(e,t,a){"use strict";a("74bc")},fbee:function(e,t,a){},fdfd:function(e,t,a){"use strict";a("bde3")}}]);