(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00b2bf02"],{"0405":function(e,t,o){},"104e":function(e,t,o){"use strict";o("0405")},f63f:function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("container",{attrs:{type:"ghost"}},[o("div",{staticClass:"app-container"},[o("div",[o("el-form",{ref:"form",attrs:{model:e.searchForm,"label-width":"80px",align:"right"},nativeOn:{submit:function(e){e.preventDefault()}}},[o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{attrs:{label:"关键字",prop:"name"}},[o("el-input",{attrs:{clearable:"",placeholder:"请输入表单ID、名称或标识KEY"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.searchForm.searchKeyword,callback:function(t){e.$set(e.searchForm,"searchKeyword",t)},expression:"searchForm.searchKeyword"}})],1)],1),o("el-col",{staticClass:"btn-container",attrs:{span:18}},[o("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.search}},[e._v("查询")]),o("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(t){return e.search("reset")}}},[e._v("重置")])],1)],1)],1)],1),o("div",{staticClass:"btn-container filter-container"},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openNewDialog}},[e._v("新建表单")])],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"row-key":"id",stripe:"",data:e.list}},e._l(e.tableColumns,(function(t){return o("el-table-column",e._b({key:t.prop,scopedSlots:e._u([{key:"default",fn:function(i){return["index"===t.prop?o("div",[e._v(e._s(i.$index+1))]):"operation"===t.prop?o("div",{staticClass:"operation-btn"},[o("el-button",{attrs:{icon:"el-icon-view",type:"text"},on:{click:function(t){return e.openView(i.row)}}},[e._v("预览")]),o("el-button",{attrs:{icon:"el-icon-edit",type:"text"},on:{click:function(t){return e.edit(i.row)}}},[e._v("编辑")]),o("el-button",{attrs:{icon:"el-icon-tickets",type:"text"},on:{click:function(t){return e.edit(i.row)}}},[e._v("版本")]),o("el-popconfirm",{attrs:{title:"您确定要删除吗？"},on:{confirm:function(t){return e.deleteById(i.row)}}},[o("el-button",{staticClass:"btn-danger",attrs:{slot:"reference",icon:"el-icon-delete",type:"text"},slot:"reference"},[e._v("删除")])],1)],1):o("span",[e._v(e._s(i.row[t.prop]))])]}}],null,!0)},"el-table-column",t,!1))})),1),o("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],attrs:{total:e.total,page:e.searchForm.page,limit:e.searchForm.pagesize},on:{"update:page":function(t){return e.$set(e.searchForm,"page",t)},"update:limit":function(t){return e.$set(e.searchForm,"pagesize",t)},pagination:e.getList}})],1),1==e.dialogNewSortVisible?o("el-dialog",{attrs:{title:"新建表单","close-on-click-modal":!1,"modal-append-to-body":!0,visible:e.dialogNewSortVisible,"custom-class":"center-dialog"},on:{"update:visible":function(t){e.dialogNewSortVisible=t},close:function(t){e.dialogNewSortVisible=!1}}},[e._t("-",[o("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"95%"},attrs:{model:e.newForm,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"表单ID",prop:"id"}},[o("el-input",{attrs:{disabled:"disabled"},model:{value:e.newForm.id,callback:function(t){e.$set(e.newForm,"id",t)},expression:"newForm.id"}})],1),o("el-form-item",{attrs:{label:"表单名称",prop:"name"}},[o("el-input",{on:{change:e.setTableName},model:{value:e.newForm.name,callback:function(t){e.$set(e.newForm,"name",t)},expression:"newForm.name"}})],1),o("el-form-item",{attrs:{label:"事件类型",prop:"eventType"}},[o("el-input",{model:{value:e.newForm.eventType,callback:function(t){e.$set(e.newForm,"eventType",t)},expression:"newForm.eventType"}})],1),o("el-form-item",{attrs:{label:"主表名",prop:"mainTable"}},[o("el-input",{model:{value:e.newForm.mainTable,callback:function(t){e.$set(e.newForm,"mainTable",t)},expression:"newForm.mainTable"}})],1),o("el-form-item",{attrs:{label:"子表名",prop:"subTable"}},[o("el-input",{model:{value:e.newForm.subTable,callback:function(t){e.$set(e.newForm,"subTable",t)},expression:"newForm.subTable"}})],1),o("el-form-item",{attrs:{label:"JS脚本",prop:"formJs"}},[o("codemirror",{attrs:{options:e.options},model:{value:e.viewCode,callback:function(t){e.viewCode=t},expression:"viewCode"}})],1)],1)]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogNewSortVisible=!1}}},[e._v(" 取消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.openFormDialog}},[e._v(" 确定")])],1)],2):e._e(),1==e.dialogVisible?o("el-drawer",{staticClass:"form-design",attrs:{title:"表单设计",visible:e.dialogVisible,size:"100%","append-to-body":!1,direction:"btt","destroy-on-close":""},on:{"update:visible":function(t){e.dialogVisible=t},close:e.closeDialog}},[o("form-designer",{attrs:{formConf:e.formConf,mapList:e.mapList,formId:e.formId}})],1):e._e(),o("el-drawer",{staticClass:"radius",attrs:{visible:e.viewVisible,title:"表单预览",size:"95%","append-to-body":!1,direction:"btt","destroy-on-close":""},on:{"update:visible":function(t){e.viewVisible=t}}},[o("preview",{attrs:{itemList:e.itemList,formConf:e.formConf}})],1)],1)},n=[],a=o("c7eb"),r=o("1da1"),s=o("5530"),l=(o("ac1f"),o("841c"),o("b0c0"),o("b64b"),o("2f62")),c=o("fb36"),m=o("550a"),d=o("b775");function p(){return Object(d["a"])({url:"/common/nextId",method:"get"})}var f=o("333d"),b=o("73a5"),u=o("bcd1"),h=o("5785"),w={add:"新增",edit:"编辑",view:"查看"},v=["#3D96F9","#F5B658","#42DDA9","#B48BE4","#C55A5A"],g=o("8f94"),F=(o("a7be"),o("b866"),o("f9d4"),o("b0b8")),y={name:"formManager",components:{Pagination:f["a"],FormDesigner:b["a"],preview:h["a"],SelectTree:c["a"],codemirror:g["codemirror"]},data:function(){return{colorList:v,titleMap:w,tabList:[],activeName:"",tableColumns:[{label:"序号",prop:"index",type:"index"},{label:"编号",prop:"id"},{label:"表单名称",prop:"name"},{label:"创建人",prop:"createBy"},{label:"创建时间",prop:"createTime"},{label:"修改人",prop:"updateBy"},{label:"修改时间",prop:"updateTime"},{label:"版本",prop:"version"},{label:"操作",prop:"operation",width:"300px"}],list:[],total:0,listLoading:!1,searchForm:{page:1,pagesize:10,searchKeyword:""},dialogVisible:!1,viewVisible:!1,dialogNewSortVisible:!1,newForm:{id:"",name:"",eventType:"",mainTable:"",subTable:"",formJs:""},itemList:[],formConf:u["a"],formId:"",mapList:[],viewCode:"",options:{tabSize:2,theme:"idea",lineNumbers:!0,line:!0,styleActiveLine:!0,hintOptions:{completeSingle:!0}}}},created:function(){this.getList()},methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])("store/page",["close"])),{},{getList:function(){var e=this;Object(m["c"])(this.searchForm).then((function(t){200===t.code?(e.list=t.rows,e.total=t.total):e.$message.error("获取列表失败"),e.listLoading=!1}))},search:function(e){"reset"===e&&this.$refs.form.resetFields(),this.searchForm.page=1,this.getList()},deleteById:function(e){var t=this;return Object(r["a"])(Object(a["a"])().mark((function o(){var i;return Object(a["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,Object(m["b"])({id:e.id});case 2:i=o.sent,200===i.code?(t.$message.success("删除成功"),t.search("reset")):t.$message.error("删除失败");case 4:case"end":return o.stop()}}),o)})))()},openNewDialog:function(e){this.dialogNewSortVisible=!0,this.getId()},setTableName:function(){this.newForm.tableName=F.getCamelChars(this.newForm.name)},openFormDialog:function(e){""!=this.newForm.name&&null!=this.newForm.name?(this.dialogNewSortVisible=!1,this.dialogVisible=!0,this.formConf=u["a"],this.formConf.tableName=this.newForm.tableName,this.formConf.formRef=this.newForm.name,this.mapList=[],this.formId=this.newForm.id):this.$message.error("请填写必填项")},openView:function(e){if(void 0==e.formJson)this.formConf=u["a"],this.itemList=[];else{var t=JSON.parse(e.formJson);this.formConf=t.config,this.itemList=t.list}this.viewVisible=!0},closeDialog:function(){this.search("reset")},edit:function(e){if(console.log("row",e),null===e.formJson||void 0===e.formJson)this.formConf=u["a"],this.mapList=[],this.formId=e.id;else{var t=JSON.parse(e.formJson);this.formConf=t.config,this.formId=e.id,this.mapList=t.list}this.dialogVisible=!0},getId:function(){var e=this;p().then((function(t){e.newForm.id=t.data,e.formId=t.data}))}})},C=y,k=(o("104e"),o("2877")),x=Object(k["a"])(C,i,n,!1,null,null,null);t["default"]=x.exports}}]);